{% extends 'started/base.html' %}

{% block title %}Register | LuxeRooms{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <div class="auth-logo">
                <i class="fas fa-door-open"></i>
                <span>Find</span>My Room
            </div>
            <h2>Create Account</h2>
            <p>Join thousands finding their perfect space</p>
        </div>
        
        <!-- Role Selection Tabs -->
        <div class="role-tabs">
            <button type="button" class="tab-btn active" data-role="client">Register as Client</button>
            <button type="button" class="tab-btn" data-role="owner">Register as Owner</button>
        </div>
        
        <form method="POST" class="auth-form">
            {% csrf_token %}
            <input type="hidden" id="role" name="role" value="client">
            
            <!-- Common Fields -->
            <div class="form-group">
                <label for="username">
                    <i class="fas fa-user"></i>
                    Username
                </label>
                <input type="text" id="username" name="username" required 
                       placeholder="Choose a username" autocomplete="username">
            </div>
            
            <div class="form-group">
                <label for="email">
                    <i class="fas fa-envelope"></i>
                    Email Address
                </label>
                <input type="email" id="email" name="email" required 
                       placeholder="Enter your email" autocomplete="email">
            </div>
            
            <div class="form-group">
                <label for="password">
                    <i class="fas fa-lock"></i>
                    Password
                </label>
                <div class="password-input-wrapper">
                    <input type="password" id="password" name="password" required 
                           placeholder="Create a password" autocomplete="new-password">
                    <button type="button" class="password-toggle" onclick="togglePassword('password')">
                        <i class="fas fa-eye" id="password-eye"></i>
                    </button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="confirm_password">
                    <i class="fas fa-lock"></i>
                    Confirm Password
                </label>
                <div class="password-input-wrapper">
                    <input type="password" id="confirm_password" name="confirm_password" required 
                           placeholder="Confirm your password" autocomplete="new-password">
                    <button type="button" class="password-toggle" onclick="togglePassword('confirm_password')">
                        <i class="fas fa-eye" id="confirm_password-eye"></i>
                    </button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="phone">
                    <i class="fas fa-phone"></i>
                    Phone Number
                </label>
                <input type="tel" id="phone" name="phone" required 
                       placeholder="Enter your phone number">
            </div>
            
            <!-- Client-specific Fields -->
            <div id="client-fields">
                <div class="form-group">
                    <label for="preferred_location">
                        <i class="fas fa-map-marker-alt"></i>
                        Preferred Location (Optional)
                    </label>
                    <input type="text" id="preferred_location" name="preferred_location" 
                           placeholder="e.g., Downtown, University Area">
                </div>
            </div>
            
            <!-- Owner-specific Fields -->
            <div id="owner-fields" style="display: none;">
                <div class="form-group">
                    <label for="address">
                        <i class="fas fa-home"></i>
                        Address
                    </label>
                    <textarea id="address" name="address" rows="3" 
                              placeholder="Enter your address"></textarea>
                </div>
            </div>
            
            <button type="submit" class="auth-btn" id="register-btn">
                <i class="fas fa-user-plus"></i>
                Register as Client
            </button>
        </form>
        
        <div class="auth-footer">
            <p>Already have an account? <a href="{% url 'login' %}">Sign in here</a></p>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabBtns = document.querySelectorAll('.tab-btn');
    const roleInput = document.getElementById('role');
    const registerBtn = document.getElementById('register-btn');
    const clientFields = document.getElementById('client-fields');
    const ownerFields = document.getElementById('owner-fields');
    const addressField = document.getElementById('address');
    
    tabBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            tabBtns.forEach(tab => tab.classList.remove('active'));
            this.classList.add('active');
            
            const role = this.dataset.role;
            roleInput.value = role;
            registerBtn.innerHTML = `<i class="fas fa-user-plus"></i> Register as ${role.charAt(0).toUpperCase() + role.slice(1)}`;
            
            if (role === 'owner') {
                clientFields.style.display = 'none';
                ownerFields.style.display = 'block';
                addressField.required = true;
            } else {
                clientFields.style.display = 'block';
                ownerFields.style.display = 'none';
                addressField.required = false;
            }
        });
    });
});

// Password visibility toggle function
function togglePassword(fieldId) {
    const passwordField = document.getElementById(fieldId);
    const eyeIcon = document.getElementById(fieldId + '-eye');
    
    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        eyeIcon.className = 'fas fa-eye-slash';
    } else {
        passwordField.type = 'password';
        eyeIcon.className = 'fas fa-eye';
    }
}
</script>

<style>
/* Password Toggle Styles */
.password-input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.password-input-wrapper input {
    padding-right: 3rem;
    flex: 1;
}

.password-toggle {
    position: absolute;
    right: 0.75rem;
    background: none;
    border: none;
    color: #6b7280;
    cursor: pointer;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.password-toggle:hover {
    color: var(--light-accent);
}

.dark-mode .password-toggle {
    color: #9ca3af;
}

.dark-mode .password-toggle:hover {
    color: var(--dark-accent);
}
</style>

{% endblock %}